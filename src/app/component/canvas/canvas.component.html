<button class="add-btn" (click)="addNode(NodeType.Route)">Add Generic Node</button>
<div class="canvas-container" (mousedown)="onMouseDown($event)" (mousemove)="onMouseMove($event)"
  (mouseup)="onMouseUp()">
  <div class="virtual-space" [ngStyle]="{'transform': 'translate(' + panX + 'px, ' + panY + 'px)'}">
    <ng-container *ngFor="let node of nodes$ | async">
      <app-server *ngIf="node.type === NodeType.Server" [nodeName]="node.name" [position]="node.position"
        (startConnection)="startConnection($event)" (mouseup)="endConnection({ node: node })"
        (nodeMoved)="onNodeMoved($event)" (dragStarted)="onDragStarted()"
        (dragEnded)="onDragEnded($event)"></app-server>
      <app-route *ngIf="node.type === NodeType.Route" [nodeName]="node.name" [position]="node.position"
        (startConnection)="startConnection($event)" (mouseup)="endConnection({ node: node })"
        (nodeMoved)="onNodeMoved($event)" (dragStarted)="onDragStarted()" (dragEnded)="onDragEnded($event)"></app-route>
      <app-middleware *ngIf="node.type === NodeType.Middleware" [nodeName]="node.name" [position]="node.position"
        (nodeMoved)="onNodeMoved($event)" (dragStarted)="onDragStarted()" (mouseup)="endConnection({ node: node })"
        (dragEnded)="onDragEnded($event)"></app-middleware>
    </ng-container>
    <svg class="connections" [ngStyle]="{'transform': 'translate(' + -panX + 'px, ' + -panY + 'px)'}">
      <path *ngFor="let connection of connections$ | async"
        [attr.d]="generatePath(connection.fromNode, connection.toNode)" stroke="black" fill="none" />
      <path *ngIf="drawingConnection" [attr.d]="generatePath(drawingConnection.fromNode, { position: cursorPosition })"
        stroke="red" fill="none" />
    </svg>
  </div>
</div>